{% extends 'base.html' %}
{% load static %}

{% block title %}
    blogger - {{post.tab_name}}
{% endblock %}

{% block content %}
<h1>{{post.title}}</h1>

{% if user.is_authenticated%}
    {% if user.id == post.author.id %}
    <a href="{% url 'edit-post' post.pk %}">Edit</a>
    <a href="{% url 'delete-post' post.pk %}">Delete</a>
    {% endif %}
{% endif %}

<small>by {{post.author}}</small>
<p>{{post.created}}</p>
<p>{{post.category}}</p>

{%if post.header_image%}
<img src="{{post.header_image.url}}" />
{%endif%}

<p>{{post.body|safe}}</p>

<a href="{% url 'post-list' %}" class="btn btn-secondary">go back</a>
<br></br>
<hr></gr>

<form action="{% url 'like-post' post.pk%}" method="POST">
    {% csrf_token %}
    {% if user.is_authenticated%}
        {% if isLiked %}
            <button class="btn btn-sm btn-danger" type="submit" name="post_id_btn_value" value="{{post.id}}">Unlike</button>
        {%else%}
            <button class="btn btn-sm btn-primary" type="submit" name="post_id_btn_value" value="{{post.id}}">Like</button>
        {%endif%}
    {%else%}
        <a class="nav-link" href="{% url 'login' %}">Login</a> to put a like
    {%endif%}

     - <p>{{total_likes}} Likes</p>
</form>

<br>

<div class="card mb-3">
  <div class="row g-0">
    <div class="col-md-2">
        <a href="{% url 'show_profile_page' post.author.profile.id %}">
            {% if post.author.profile.avatar %}
                <img src="{{post.author.profile.avatar.url}}" class="rounded-circle card-img" />
            {%else%}
                <img src="{% static 'blogger/images/avatar-default.png' %}" class="rounded-circle card-img" />
            {%endif%}
        </a>
    </div>
    <div class="col-md-10">
      <div class="card-body">
        <h5 class="card-title">{{post.author.first_name}} {{post.author.last_name}}</h5>
          <p class="small text-muted">
              {% if post.author.profile.fb_url %}
                <a href="{{post.author.profile.fb_url}}" >Facebook</a> |
              {%endif%}
              {% if post.author.profile.linked_url %}
                <a href="{{post.author.profile.linked_url}}" >LinkedIn</a> |
              {%endif%}
          </p>
        <p class="card-text">{{post.author.profile.bio}}</p>
      </div>
    </div>
  </div>
</div>


<br>
<br>

<h2>Comments</h2>
{%if not post.comments.all %}
  no comments
{%else%}
    {% for comment in post.comments.all %}
        {{comment.name}} -
        {{comment.created}} -
        <br>
        {{comment.body}}
    {% endfor %}
{% endif %}
<br>
<a href="{% url 'comment-new' post.pk %}">Add comment</a>

<br>


{% endblock %}